insert into shipping_mode_dim 
select 100+row_number() over(), ship_mode from (select distinct ship_mode from orders) a

truncate table customer_dim cascade;
insert into customer_dim 
select 100+row_number() over(), customer_name, segment, customer_id
from (select customer_name, segment, customer_id from orders) a
group by customer_name, segment, customer_id 
/*group by аналогично использованию distinct в запросе*/

truncate table geography_dim cascade;
insert into geography_dim 
select 100+row_number() over(), country, city, state, postal_code, region
from (select country, city, state, postal_code, region from orders) a
group by country, city, state, postal_code, region

truncate table product_dim cascade;
insert into product_dim
select 100+row_number() over(), product_id, category, subcategory, product_name
from (select product_id, category, subcategory, product_name from orders) a
group by product_id, category, subcategory, product_name